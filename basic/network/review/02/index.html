<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>HTTP &#183; NewtSun</title><meta name=title content="HTTP &#183; NewtSun"><meta name=keywords content="network,review,"><link rel=canonical href=https://newtsun.github.io/basic/network/review/02/><link type=text/css rel=stylesheet href=/css/main.bundle.min.24be37d0eaaebe41c52830ebd6674e9b0772d04c4acf37449ca01896e7adb1599d52a071142e7525f3054f3da0c0aae69065d64bfe59b713d4e8d235fe3c1d54.css integrity="sha512-JL430OquvkHFKDDr1mdOmwdy0ExKzzdEnKAYluetsVmdUqBxFC51JfMFTz2gwKrmkGXWS/5ZtxPU6NI1/jwdVA=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ+dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5+a8AgFUkA==" data-copy data-copied></script>
<script src=/js/zoom.min.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="HTTP"><meta property="og:description" content="HTTP 相关技术"><meta property="og:type" content="article"><meta property="og:url" content="https://newtsun.github.io/basic/network/review/02/"><meta property="og:image" content="https://newtsun.github.io/basic/network/review/02/feature.jpg"><meta property="article:section" content="basic"><meta property="article:published_time" content="2023-09-18T14:24:21+08:00"><meta property="article:modified_time" content="2023-09-18T14:24:21+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://newtsun.github.io/basic/network/review/02/feature.jpg"><meta name=twitter:title content="HTTP"><meta name=twitter:description content="HTTP 相关技术"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Basics","name":"HTTP","headline":"HTTP","abstract":"HTTP 相关技术","inLanguage":"en","url":"https:\/\/newtsun.github.io\/basic\/network\/review\/02\/","author":{"@type":"Person","name":""},"copyrightYear":"2023","dateCreated":"2023-09-18T14:24:21\u002b08:00","datePublished":"2023-09-18T14:24:21\u002b08:00","dateModified":"2023-09-18T14:24:21\u002b08:00","keywords":["network","review"],"mainEntityOfPage":"true","wordCount":"681"}]</script><script src=/lib/jquery/jquery.slim.min.js integrity></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">NewtSun</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/golang/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Golang>Golang</p></a><a href=/python/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Pythons>Python</p></a><a href=/linux/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Linuxes>Linux</p></a><a href=/basic/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Basics>Basic</p></a><a href=/cloud/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Clouds>Cloud</p></a><a href=/diary/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=Diaries>Diary</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/golang/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Golang>Golang</p></a></li><li class=mt-1><a href=/python/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Pythons>Python</p></a></li><li class=mt-1><a href=/linux/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Linuxes>Linux</p></a></li><li class=mt-1><a href=/basic/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Basics>Basic</p></a></li><li class=mt-1><a href=/cloud/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Clouds>Cloud</p></a></li><li class=mt-1><a href=/diary/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=Diaries>Diary</p></a></li></ul></div></label></div></div><script>(function(){var e=$(".main-menu"),t=window.location.pathname;e.find('a[href="'+t+'"]').each(function(e,t){$(t).children("p").addClass("active")})})()</script></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/basic/network/review/02/feature_hu12378723d8d648ccbd45d949c7a79f70_4475730_1200x0_resize_q75_box.jpg)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>Welcome to NewtSun</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/basic/>Basics</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/basic/network/review/02/>HTTP</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">HTTP</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2023-09-18 14:24:21 +0800 +0800">18 September 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">4 mins</span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/network/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">network</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/review/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">review</span></span></span></div></div><div class=flex><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#1http--11>1.HTTP / 1.1</a><ul><li><a href=#11-http11-的优点>1.1 HTTP/1.1 的优点</a></li><li><a href=#12-http11-的缺点>1.2 HTTP/1.1 的缺点</a></li><li><a href=#13-http11-的性能>1.3 HTTP/1.1 的性能</a></li></ul></li><li><a href=#2http-与-https>2.HTTP 与 HTTPS</a><ul><li><a href=#21-http-与-https-区别>2.1 HTTP 与 HTTPS 区别</a></li><li><a href=#22-https-解决了-http-的哪些问题>2.2 HTTPS 解决了 HTTP 的哪些问题</a></li><li><a href=#23-https-是如何建立连接四次握手>2.3 HTTPS 是如何建立连接（四次握手）</a></li><li><a href=#24-数字证书签发和验证流程>2.4 数字证书签发和验证流程</a></li><li><a href=#25-https-的应用数据是如何保证完整性的>2.5 HTTPS 的应用数据是如何保证完整性的</a></li><li><a href=#26-中间人服务器>2.6 中间人服务器</a></li><li><a href=#27-如何避免中间人攻击>2.7 如何避免中间人攻击</a></li></ul></li><li><a href=#3http11http2http3-演变>3.HTTP/1.1、HTTP/2、HTTP/3 演变</a><ul><li><a href=#31-http11-相比-http10-提高了什么性能>3.1 HTTP/1.1 相比 HTTP/1.0 提高了什么性能</a></li><li><a href=#32-http2-的优化>3.2 HTTP/2 的优化</a></li><li><a href=#33-http3-的优化>3.3 HTTP/3 的优化</a></li></ul></li><li><a href=#4http-缓存技术>4.HTTP 缓存技术</a><ul><li><a href=#41-强制缓存>4.1 强制缓存</a></li><li><a href=#42-协商缓存>4.2 协商缓存</a></li></ul></li></ul></nav></div></details><details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#1http--11>1.HTTP / 1.1</a><ul><li><a href=#11-http11-的优点>1.1 HTTP/1.1 的优点</a></li><li><a href=#12-http11-的缺点>1.2 HTTP/1.1 的缺点</a></li><li><a href=#13-http11-的性能>1.3 HTTP/1.1 的性能</a></li></ul></li><li><a href=#2http-与-https>2.HTTP 与 HTTPS</a><ul><li><a href=#21-http-与-https-区别>2.1 HTTP 与 HTTPS 区别</a></li><li><a href=#22-https-解决了-http-的哪些问题>2.2 HTTPS 解决了 HTTP 的哪些问题</a></li><li><a href=#23-https-是如何建立连接四次握手>2.3 HTTPS 是如何建立连接（四次握手）</a></li><li><a href=#24-数字证书签发和验证流程>2.4 数字证书签发和验证流程</a></li><li><a href=#25-https-的应用数据是如何保证完整性的>2.5 HTTPS 的应用数据是如何保证完整性的</a></li><li><a href=#26-中间人服务器>2.6 中间人服务器</a></li><li><a href=#27-如何避免中间人攻击>2.7 如何避免中间人攻击</a></li></ul></li><li><a href=#3http11http2http3-演变>3.HTTP/1.1、HTTP/2、HTTP/3 演变</a><ul><li><a href=#31-http11-相比-http10-提高了什么性能>3.1 HTTP/1.1 相比 HTTP/1.0 提高了什么性能</a></li><li><a href=#32-http2-的优化>3.2 HTTP/2 的优化</a></li><li><a href=#33-http3-的优化>3.3 HTTP/3 的优化</a></li></ul></li><li><a href=#4http-缓存技术>4.HTTP 缓存技术</a><ul><li><a href=#41-强制缓存>4.1 强制缓存</a></li><li><a href=#42-协商缓存>4.2 协商缓存</a></li></ul></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=t.attr("id"))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){n()})}})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="max-w-prose mb-20"><p>HTTP 相关技术</p><div id=1http--11 class=anchor></div><h2 class="relative group">1.HTTP / 1.1
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1http--11 aria-label=Anchor>#</a></span></h2><div id=11-http11-的优点 class=anchor></div><h3 class="relative group">1.1 HTTP/1.1 的优点
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#11-http11-%e7%9a%84%e4%bc%98%e7%82%b9 aria-label=Anchor>#</a></span></h3><p>HTTP 最突出的优点是「简单、灵活和易于扩展、应用广泛和跨平台」。</p><p><strong>1. 简单</strong></p><p>HTTP 基本的报文格式就是 <code>header + body</code>，头部信息也是 <code>key-value</code> 简单文本的形式，<strong>易于理解</strong>，降低了学习和使用的门槛。</p><p><strong>2. 灵活和易于扩展</strong></p><p>HTTP 协议里的各类请求方法、URI/URL、状态码、头字段等每个组成要求都没有被固定死，都允许开发人员<strong>自定义和扩充</strong>。</p><p>同时 HTTP 由于是工作在应用层（ <code>OSI</code> 第七层），则它<strong>下层可以随意变化</strong>，比如：</p><ul><li>HTTPS 就是在 HTTP 与 TCP 层之间增加了 SSL/TLS 安全传输层；</li><li>HTTP/1.1 和 HTTP/2.0 传输协议使用的是 TCP 协议，而到了 HTTP/3.0 传输协议改用了 UDP 协议。</li></ul><p><strong>3. 应用广泛和跨平台</strong></p><p>互联网发展至今，HTTP 的应用范围非常的广泛，从台式机的浏览器到手机上的各种 APP，从看新闻、刷贴吧到购物、理财、吃鸡，HTTP 的应用遍地开花，同时天然具有<strong>跨平台</strong>的优越性。</p><div id=12-http11-的缺点 class=anchor></div><h3 class="relative group">1.2 HTTP/1.1 的缺点
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#12-http11-%e7%9a%84%e7%bc%ba%e7%82%b9 aria-label=Anchor>#</a></span></h3><p>HTTP 协议里有优缺点一体的<strong>双刃剑</strong>，分别是「无状态、明文传输」，同时还有一大缺点「不安全」。</p><p><strong>1. 无状态</strong></p><p>无状态的<strong>好处</strong>，因为服务器不会去记忆 HTTP 的状态，所以不需要额外的资源来记录状态信息，这能减轻服务器的负担，能够把更多的 CPU 和内存用来对外提供服务。</p><p>无状态的<strong>坏处</strong>，既然服务器没有记忆能力，它在完成有关联性的操作时会非常麻烦。</p><p>对于无状态的问题，<strong>解法方案有很多种，其中比较简单的方式用 Cookie 技术</strong>。</p><p><code>Cookie</code> 通过在请求和响应报文中写入 Cookie 信息来控制客户端的状态。</p><p>相当于，<strong>在客户端第一次请求后，服务器会下发一个装有客户信息的「小贴纸」，后续客户端请求服务器的时候，带上「小贴纸」，服务器就能认得了了。</strong></p><p><strong>2. 明文传输</strong></p><p>明文意味着在传输过程中的信息，是可方便阅读的，比如 Wireshark 抓包都可以直接肉眼查看，为我们调试工作带了极大的便利性。</p><p>但是这正是这样，HTTP 的所有信息都容易被窃取。</p><p><strong>3. 不安全</strong></p><p>HTTP 比较严重的缺点就是不安全：</p><ul><li>通信使用明文（不加密），内容可能会被窃听。</li><li>不验证通信方的身份，因此有可能遭遇伪装。</li><li>无法证明报文的完整性，所以有可能已遭篡改。</li></ul><p>HTTP 的安全问题，可以用 HTTPS 的方式解决，也就是通过引入 SSL/TLS 层，使得在安全上达到了极致。</p><div id=13-http11-的性能 class=anchor></div><h3 class="relative group">1.3 HTTP/1.1 的性能
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#13-http11-%e7%9a%84%e6%80%a7%e8%83%bd aria-label=Anchor>#</a></span></h3><p>HTTP 协议是基于 <strong>TCP/IP</strong>，并且使用了「<strong>请求 - 应答</strong>」的通信模式，所以性能的关键就在这<strong>两点</strong>里。</p><p><strong>1. 长连接</strong></p><p>早期 HTTP/1.0 性能上的一个很大的问题，那就是每发起一个请求，都要新建一次 TCP 连接（三次握手），而且是串行请求，做了无谓的 TCP 连接建立和断开，增加了通信开销。</p><p>为了解决上述 TCP 连接问题，HTTP/1.1 提出了<strong>长连接</strong>的通信方式，也叫持久连接。这种方式的好处在于减少了 TCP 连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。</p><p>持久连接的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。</p><p>当然，如果某个 HTTP 长连接超过一定时间没有任何数据交互，服务端就会主动断开这个连接。</p><p><strong>2. 管道网络传输</strong></p><p>HTTP/1.1 采用了长连接的方式，这使得管道（pipeline）网络传输成为了可能。</p><p>即可在同一个 TCP 连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以<strong>减少整体的响应时间。</strong></p><p>举例来说，客户端需要请求两个资源。以前的做法是，在同一个 TCP 连接里面，先发送 A 请求，然后等待服务器做出回应，收到后再发出 B 请求。那么，管道机制则是允许浏览器同时发出 A 请求和 B 请求。</p><p>但是<strong>服务器必须按照接收请求的顺序发送对这些管道化请求的响应</strong>。</p><p>如果服务端在处理 A 请求时耗时比较长，那么后续的请求的处理都会被阻塞住，这称为「队头堵塞」。</p><p>所以，<strong>HTTP/1.1 管道解决了请求的队头阻塞，但是没有解决响应的队头阻塞</strong>。</p><p><strong>3. 队头阻塞</strong></p><p>「请求 - 应答」的模式会造成 HTTP 的性能问题。</p><p>因为当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一同被阻塞了，会招致客户端一直请求不到数据，这也就是「<strong>队头阻塞</strong>」，好比上班的路上塞车。</p><p>总之 HTTP/1.1 的性能一般般，后续的 HTTP/2 和 HTTP/3 就是在优化 HTTP 的性能。</p><div id=2http-与-https class=anchor></div><h2 class="relative group">2.HTTP 与 HTTPS
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2http-%e4%b8%8e-https aria-label=Anchor>#</a></span></h2><div id=21-http-与-https-区别 class=anchor></div><h3 class="relative group">2.1 HTTP 与 HTTPS 区别
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#21-http-%e4%b8%8e-https-%e5%8c%ba%e5%88%ab aria-label=Anchor>#</a></span></h3><ul><li>HTTP 是超文本传输协议，信息是明文传输，存在安全风险的问题。HTTPS 则解决 HTTP 不安全的缺陷，在 TCP 和 HTTP 网络层之间加入了 SSL/TLS 安全协议，使得报文能够加密传输。</li><li>HTTP 连接建立相对简单， TCP 三次握手之后便可进行 HTTP 的报文传输。而 HTTPS 在 TCP 三次握手之后，还需进行 SSL/TLS 的握手过程，才可进入加密报文传输。</li><li>两者的默认端口不一样，<strong>HTTP 默认端口号是 80</strong>，<strong>HTTPS 默认端口号是 443</strong>。</li><li>HTTPS 协议需要向 CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的。</li></ul><div id=22-https-解决了-http-的哪些问题 class=anchor></div><h3 class="relative group">2.2 HTTPS 解决了 HTTP 的哪些问题
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#22-https-%e8%a7%a3%e5%86%b3%e4%ba%86-http-%e7%9a%84%e5%93%aa%e4%ba%9b%e9%97%ae%e9%a2%98 aria-label=Anchor>#</a></span></h3><ul><li><strong>窃听风险</strong>，比如通信链路上可以获取通信内容。</li><li><strong>篡改风险</strong>，比如强制植入垃圾广告，视觉污染。</li><li><strong>冒充风险</strong>，比如冒充淘宝网站。</li></ul><p>HTTP<strong>S</strong> 在 HTTP 与 TCP 层之间加入了 <code>SSL/TLS</code> 协议，可以很好的解决了上述的风险：</p><ul><li><strong>信息加密</strong>：交互信息无法被窃取。</li><li><strong>校验机制</strong>：无法篡改通信内容，篡改了就不能正常显示。</li><li><strong>身份证书</strong>：证明淘宝是真的淘宝网。</li></ul><p><strong>HTTPS 是如何解决上面的三个风险的：</strong></p><ul><li><strong>混合加密</strong>的方式实现信息的<strong>机密性</strong>，解决了窃听的风险。</li><li><strong>摘要算法</strong>的方式来实现<strong>完整性</strong>，它能够为数据生成独一无二的「指纹」，指纹用于校验数据的完整性，解决了篡改的风险。</li><li>将服务器公钥放入到<strong>数字证书</strong>中，解决了冒充的风险。</li></ul><div id=23-https-是如何建立连接四次握手 class=anchor></div><h3 class="relative group">2.3 HTTPS 是如何建立连接（四次握手）
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#23-https-%e6%98%af%e5%a6%82%e4%bd%95%e5%bb%ba%e7%ab%8b%e8%bf%9e%e6%8e%a5%e5%9b%9b%e6%ac%a1%e6%8f%a1%e6%89%8b aria-label=Anchor>#</a></span></h3><p>SSL/TLS 协议基本流程：</p><ul><li>客户端向服务器索要并验证服务器的公钥。</li><li>双方协商生产「会话秘钥」。</li><li>双方采用「会话秘钥」进行加密通信。</li></ul><p>前两步也就是 SSL/TLS 的建立过程，也就是 TLS 握手阶段。</p><p>TLS 的「握手阶段」涉及<strong>四次</strong>通信，使用不同的密钥交换算法，TLS 握手流程也会不一样的，现在常用的密钥交换算法有两种：<strong>RSA</strong> 算法 和 <strong>ECDHE</strong> 算法。</p><p><strong>TLS 协议建立的详细流程：</strong></p><p><strong>1. ClientHello</strong></p><p>首先，由客户端向服务器发起加密通信请求，也就是 <code>ClientHello</code> 请求。</p><p>客户端主要向服务器发送以下信息：</p><p>（1）客户端支持的 TLS 协议版本，如 TLS 1.2 版本。</p><p>（2）客户端生产的随机数（<code>Client Random</code>），后面用于生成「会话秘钥」条件之一。</p><p>（3）客户端支持的密码套件列表，如 RSA 加密算法。</p><p><strong>2. SeverHello</strong></p><p>服务器收到客户端请求后，向客户端发出响应，也就是 <code>SeverHello</code>。服务器回应的内容有如下内容：</p><p>（1）确认 TLS 协议版本，如果浏览器不支持，则关闭加密通信。</p><p>（2）服务器生产的随机数（<code>Server Random</code>），也是后面用于生产「会话秘钥」条件之一。</p><p>（3）确认的密码套件列表，如 RSA 加密算法。</p><p>（4）服务器的数字证书。</p><p><strong>3.客户端回应</strong></p><p>客户端收到服务器的回应之后，<strong>首先通过浏览器或者操作系统中的 CA 公钥，确认服务器的数字证书的真实性。</strong></p><p>如果证书没有问题，客户端会<strong>从数字证书中取出服务器的公钥</strong>，然后使用它加密报文，向服务器发送：</p><p>（1）一个随机数（<code>pre-master key</code>）。该随机数会被服务器公钥加密。</p><p>（2）加密通信算法改变通知，表示随后的信息都将用「会话秘钥」加密通信。</p><p>（3）客户端握手结束通知，表示客户端的握手阶段已经结束。这一项同时把之前所有内容的发生的数据做个摘要，用来供服务端校验。</p><p>上面第一项的随机数是整个握手阶段的第三个随机数，会发给服务端，所以这个随机数客户端和服务端都是一样的。</p><p><strong>服务器和客户端有了这三个随机数（Client Random、Server Random、pre-master key），接着就用双方协商的加密算法，各自生成本次通信的「会话秘钥」</strong>。</p><p><strong>4. 服务器的最后回应</strong></p><p>服务器收到客户端的第三个随机数（<code>pre-master key</code>）之后，通过协商的加密算法，计算出本次通信的「会话秘钥」。</p><p>然后，向客户端发送最后的信息：</p><p>（1）加密通信算法改变通知，表示随后的信息都将用「会话秘钥」加密通信。</p><p>（2）服务器握手结束通知，表示服务器的握手阶段已经结束。这一项同时把之前所有内容的发生的数据做个摘要，用来供客户端校验。</p><p>至此，整个 TLS 的握手阶段全部结束。接下来，客户端与服务器进入加密通信，就完全是使用普通的 HTTP 协议，只不过用「会话秘钥」加密内容。</p><div id=24-数字证书签发和验证流程 class=anchor></div><h3 class="relative group">2.4 数字证书签发和验证流程
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#24-%e6%95%b0%e5%ad%97%e8%af%81%e4%b9%a6%e7%ad%be%e5%8f%91%e5%92%8c%e9%aa%8c%e8%af%81%e6%b5%81%e7%a8%8b aria-label=Anchor>#</a></span></h3><p><figure><img class="my-0 rounded-md" srcset="/basic/network/review/02/img/image-20230918144842197_hu9435568d0cd9cc8906d383efd48fc5f7_336269_330x0_resize_box_3.png 330w,
/basic/network/review/02/img/image-20230918144842197_hu9435568d0cd9cc8906d383efd48fc5f7_336269_660x0_resize_box_3.png 660w,
/basic/network/review/02/img/image-20230918144842197_hu9435568d0cd9cc8906d383efd48fc5f7_336269_1024x0_resize_box_3.png 1024w,
/basic/network/review/02/img/image-20230918144842197_hu9435568d0cd9cc8906d383efd48fc5f7_336269_1320x0_resize_box_3.png 2x" src=/basic/network/review/02/img/image-20230918144842197_hu9435568d0cd9cc8906d383efd48fc5f7_336269_660x0_resize_box_3.png alt></figure></p><p>CA 签发证书的过程：</p><ul><li>首先 CA 会把持有者的公钥、用途、颁发者、有效时间等信息打成一个包，然后对这些信息进行 <strong>Hash</strong> 计算，得到一个 Hash 值；</li><li>然后 CA 会使用自己的私钥将该 Hash 值加密，生成 Certificate Signature，也就是 CA 对证书做了签名；</li><li>最后将 Certificate Signature 添加在文件证书上，形成数字证书；</li></ul><p>客户端校验服务端的数字证书的过程，如上图右边部分：</p><ul><li>首先客户端会<strong>使用同样的 Hash 算法获取该证书的 Hash 值 H1</strong>；</li><li><strong>通常浏览器和操作系统中集成了 CA 的公钥信息</strong>，<strong>浏览器收到证书后可以使用 CA 的公钥解密 Certificate Signature 内容，得到一个 Hash 值 H2</strong> ；</li><li>最后<strong>比较 H1 和 H2</strong>，如果值相同，则为可信赖的证书，否则则认为证书不可信。</li></ul><div id=25-https-的应用数据是如何保证完整性的 class=anchor></div><h3 class="relative group">2.5 HTTPS 的应用数据是如何保证完整性的
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#25-https-%e7%9a%84%e5%ba%94%e7%94%a8%e6%95%b0%e6%8d%ae%e6%98%af%e5%a6%82%e4%bd%95%e4%bf%9d%e8%af%81%e5%ae%8c%e6%95%b4%e6%80%a7%e7%9a%84 aria-label=Anchor>#</a></span></h3><p>TLS 在实现上分为<strong>握手协议</strong>和<strong>记录协议</strong>两层：</p><ul><li>TLS 握手协议负责协商加密算法和生成对称密钥，后续用此密钥来保护应用程序数据（即 HTTP 数据）；</li><li>TLS 记录协议负责保护应用程序数据并验证其完整性和来源，所以对 HTTP 数据加密是使用记录协议；</li></ul><p>TLS <strong>记录协议主要负责消息（HTTP 数据）的压缩，加密及数据的认证</strong>，过程如下图：</p><p><figure><img class="my-0 rounded-md" srcset="/basic/network/review/02/img/image-20230918145004173_hud828befb9936bf1eece581c47251505f_402462_330x0_resize_box_3.png 330w,
/basic/network/review/02/img/image-20230918145004173_hud828befb9936bf1eece581c47251505f_402462_660x0_resize_box_3.png 660w,
/basic/network/review/02/img/image-20230918145004173_hud828befb9936bf1eece581c47251505f_402462_1024x0_resize_box_3.png 1024w,
/basic/network/review/02/img/image-20230918145004173_hud828befb9936bf1eece581c47251505f_402462_1320x0_resize_box_3.png 2x" src=/basic/network/review/02/img/image-20230918145004173_hud828befb9936bf1eece581c47251505f_402462_660x0_resize_box_3.png alt></figure></p><p>具体过程如下：</p><ul><li>首先，消息被分割成多个较短的片段,然后分别对每个片段进行压缩。</li><li>接下来，经过压缩的片段会被<strong>加上消息认证码（MAC 值，这个是通过哈希算法生成的），这是为了保证完整性，并进行数据的认证</strong>。通过附加消息认证码的 MAC 值，可以识别出篡改。与此同时，为了防止重放攻击，在计算消息认证码时，还加上了片段的编码。</li><li>再接下来，经过压缩的片段再加上消息认证码会一起通过对称密码进行加密。</li><li>最后，上述经过加密的数据再加上由数据类型、版本号、压缩后的长度组成的报头就是最终的报文数据。</li></ul><p>记录协议完成后，最终的报文数据将传递到传输控制协议 (TCP) 层进行传输。</p><div id=26-中间人服务器 class=anchor></div><h3 class="relative group">2.6 中间人服务器
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#26-%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=Anchor>#</a></span></h3><p>客户端通过浏览器向服务端发起 HTTPS 请求时，被「假基站」转发到了一个「中间人服务器」，于是客户端是和「中间人服务器」完成了 TLS 握手，然后这个「中间人服务器」再与真正的服务端完成 TLS 握手。</p><p><figure><img class="my-0 rounded-md" srcset="/basic/network/review/02/img/image-20230918145132636_hubd674da5d9214fc338dde750c72cbb8e_657793_330x0_resize_box_3.png 330w,
/basic/network/review/02/img/image-20230918145132636_hubd674da5d9214fc338dde750c72cbb8e_657793_660x0_resize_box_3.png 660w,
/basic/network/review/02/img/image-20230918145132636_hubd674da5d9214fc338dde750c72cbb8e_657793_1024x0_resize_box_3.png 1024w,
/basic/network/review/02/img/image-20230918145132636_hubd674da5d9214fc338dde750c72cbb8e_657793_1320x0_resize_box_3.png 2x" src=/basic/network/review/02/img/image-20230918145132636_hubd674da5d9214fc338dde750c72cbb8e_657793_660x0_resize_box_3.png alt></figure></p><p>具体过程如下：</p><ul><li>客户端向服务端发起 HTTPS 建立连接请求时，然后被「假基站」转发到了一个「中间人服务器」，接着中间人向服务端发起 HTTPS 建立连接请求，此时客户端与中间人进行 TLS 握手，中间人与服务端进行 TLS 握手；</li><li>在客户端与中间人进行 TLS 握手过程中，中间人会发送自己的公钥证书给客户端，<strong>客户端验证证书的真伪</strong>，然后从证书拿到公钥，并生成一个随机数，用公钥加密随机数发送给中间人，中间人使用私钥解密，得到随机数，此时双方都有随机数，然后通过算法生成对称加密密钥（A），后续客户端与中间人通信就用这个对称加密密钥来加密数据了。</li><li>在中间人与服务端进行 TLS 握手过程中，服务端会发送从 CA 机构签发的公钥证书给中间人，从证书拿到公钥，并生成一个随机数，用公钥加密随机数发送给服务端，服务端使用私钥解密，得到随机数，此时双方都有随机数，然后通过算法生成对称加密密钥（B），后续中间人与服务端通信就用这个对称加密密钥来加密数据了。</li><li>后续的通信过程中，中间人用对称加密密钥（A）解密客户端的 HTTPS 请求的数据，然后用对称加密密钥（B）加密 HTTPS 请求后，转发给服务端，接着服务端发送 HTTPS 响应数据给中间人，中间人用对称加密密钥（B）解密 HTTPS 响应数据，然后再用对称加密密钥（A）加密后，转发给客户端。</li></ul><p>从客户端的角度看，其实并不知道网络中存在中间人服务器这个角色。那么中间人就可以解开浏览器发起的 HTTPS 请求里的数据，也可以解开服务端响应给浏览器的 HTTPS 响应数据。相当于，中间人能够 “偷看” 浏览器与服务端之间的 HTTPS 请求和响应的数据。</p><p>但是要发生这种场景是有前提的，前提是用户点击接受了中间人服务器的证书。</p><p>中间人服务器与客户端在 TLS 握手过程中，实际上发送了自己伪造的证书给浏览器，而这个伪造的证书是能被浏览器（客户端）识别出是非法的，于是就会提醒用户该证书存在问题。</p><p>所以，<strong>HTTPS 协议本身到目前为止还是没有任何漏洞的，即使你成功进行中间人攻击，本质上是利用了客户端的漏洞（用户点击继续访问或者被恶意导入伪造的根证书），并不是 HTTPS 不够安全</strong>。</p><div id=27-如何避免中间人攻击 class=anchor></div><h3 class="relative group">2.7 如何避免中间人攻击
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#27-%e5%a6%82%e4%bd%95%e9%81%bf%e5%85%8d%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb aria-label=Anchor>#</a></span></h3><blockquote><p>为什么抓包工具能截取 HTTPS 数据？</p></blockquote><p>很多抓包工具 之所以可以明文看到 HTTPS 数据，<strong>工作原理与中间人一致的</strong>。</p><p>对于 HTTPS 连接来说，中间人要满足以下两点，才能实现真正的明文代理:</p><ol><li>中间人，作为客户端与真实服务端建立连接这一步不会有问题，因为服务端不会校验客户端的身份；</li><li>中间人，<strong>作为服务端与真实客户端建立连接</strong>，<strong>这里会有客户端信任服务端的问题</strong>，也就是<strong>服务端必须有对应域名的私钥</strong>；</li></ol><p>中间人要拿到<strong>私钥</strong>只能通过如下方式：</p><ol><li>去网站服务端拿到私钥；</li><li>去CA处拿域名签发私钥；</li><li><strong>自己签发证书，切要被浏览器信任</strong>；</li></ol><p>不用解释，<strong>抓包工具只能使用第三种方式取得中间人的身份</strong>。</p><p>使用抓包工具进行 HTTPS 抓包的时候，<strong>需要在客户端安装 Fiddler 的根证书</strong>，这里<strong>实际上起认证中心（CA）的作用</strong>。</p><p>抓包工具能够抓包的关键是<strong>客户端会往系统受信任的根证书列表中导入抓包工具生成的证书</strong>，而这个证书会被浏览器信任，也就是<strong>抓包工具给自己创建了一个认证中心 CA，客户端拿着中间人签发的证书去中间人自己的 CA 去认证，当然认为这个证书是有效的</strong>。</p><blockquote><p>如何避免被中间人抓取数据？</p></blockquote><p>我们要保证自己电脑的安全，不要被病毒乘虚而入，而且也不要点击任何证书非法的网站，这样 HTTPS 数据就不会被中间人截取到了。</p><p>当然，我们还可以通过 <strong>HTTPS 双向认证</strong>来避免这种问题。</p><p>一般我们的 HTTPS 是单向认证，客户端只会验证了服务端的身份，但是服务端并不会验证客户端的身份。</p><p><figure><img class="my-0 rounded-md" srcset="/basic/network/review/02/img/image-20230918145302835_huf8fa69af443bc0c0fddf95bd19a42e5f_276464_330x0_resize_box_3.png 330w,
/basic/network/review/02/img/image-20230918145302835_huf8fa69af443bc0c0fddf95bd19a42e5f_276464_660x0_resize_box_3.png 660w,
/basic/network/review/02/img/image-20230918145302835_huf8fa69af443bc0c0fddf95bd19a42e5f_276464_1024x0_resize_box_3.png 1024w,
/basic/network/review/02/img/image-20230918145302835_huf8fa69af443bc0c0fddf95bd19a42e5f_276464_1320x0_resize_box_3.png 2x" src=/basic/network/review/02/img/image-20230918145302835_huf8fa69af443bc0c0fddf95bd19a42e5f_276464_660x0_resize_box_3.png alt></figure></p><p>如果用了双向认证方式，不仅客户端会验证服务端的身份，而且服务端也会验证客户端的身份。服务端一旦验证到请求自己的客户端为不可信任的，服务端就拒绝继续通信，客户端如果发现服务端为不可信任的，那么也中止通信。</p><div id=3http11http2http3-演变 class=anchor></div><h2 class="relative group">3.HTTP/1.1、HTTP/2、HTTP/3 演变
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3http11http2http3-%e6%bc%94%e5%8f%98 aria-label=Anchor>#</a></span></h2><div id=31-http11-相比-http10-提高了什么性能 class=anchor></div><h3 class="relative group">3.1 HTTP/1.1 相比 HTTP/1.0 提高了什么性能
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#31-http11-%e7%9b%b8%e6%af%94-http10-%e6%8f%90%e9%ab%98%e4%ba%86%e4%bb%80%e4%b9%88%e6%80%a7%e8%83%bd aria-label=Anchor>#</a></span></h3><p>HTTP/1.1 相比 HTTP/1.0 <strong>性能上的改进</strong>：</p><ul><li>使用<strong>长连接</strong>的方式改善了 HTTP/1.0 <strong>短连接造成的性能开销</strong>。</li><li><strong>支持管道</strong>（pipeline）网络传输，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。</li></ul><p>但 HTTP/1.1 还是<strong>有性能瓶颈</strong>：</p><ul><li><strong>请求 / 响应头部（Header）未经压缩就发送</strong>，<strong>首部信息越多延迟越大</strong>。只能压缩 <code>Body</code> 的部分；</li><li>发送冗长的首部。每次互相<strong>发送相同的首部造成的浪费较多</strong>；</li><li><strong>服务器是按请求的顺序响应的</strong>，如果服务器响应慢，会招致客户端一直请求不到数据，也就是<strong>队头阻塞</strong>；</li><li><strong>没有请求优先级控制</strong>；</li><li><strong>请求只能从客户端开始，服务器只能被动响应</strong>。</li></ul><div id=32-http2-的优化 class=anchor></div><h3 class="relative group">3.2 HTTP/2 的优化
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#32-http2-%e7%9a%84%e4%bc%98%e5%8c%96 aria-label=Anchor>#</a></span></h3><p>HTTP/2 相比 HTTP/1.1 <strong>性能上的改进</strong>：</p><ul><li><strong>头部压缩：通过<code>HPACK</code> 算法，在客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，之后就不发送同样字段了，只发送索引号，可以</strong>提高速度。</li><li><strong>二进制格式：HTTP/2 不再像 HTTP/1.1 里的纯文本形式的报文，而是全面采用了</strong>二进制格式**，头信息和数据体都是二进制，并且统称为帧（frame）：<strong>头信息帧（Headers Frame）和数据帧（Data Frame）</strong>。</li><li><strong>并发传输：HTTP/1.1 的实现是基于请求-响应模型的，可能会出现队头阻塞的情况，而 HTTP/2 针对不同的 HTTP 请求用</strong>独一无二的 Stream ID 来区分，接收端可以通过 Stream ID 有序组装成 HTTP 消息，不同 Stream 的帧是可以乱序发送的，<strong>因此可以并发不同的 Stream ，也就是 HTTP/2 可以并行交错地发送请求和响应</strong>。</li><li><strong>服务器主动推送资源：HTTP/2 还在一定程度上改善了传统的「请求 - 应答」工作模式，服务端不再是被动地响应，可以</strong>主动<strong>向客户端发送消息。（客户端和服务器</strong>双方都可以建立 Stream， Stream ID 也是有区别的，客户端建立的 Stream 必须是奇数号，而服务器建立的 Stream 必须是偶数号）。</li></ul><div id=33-http3-的优化 class=anchor></div><h3 class="relative group">3.3 HTTP/3 的优化
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#33-http3-%e7%9a%84%e4%bc%98%e5%8c%96 aria-label=Anchor>#</a></span></h3><p>HTTP/2 队头阻塞的问题是因为 <strong>TCP</strong>，所以 <strong>HTTP/3 把 HTTP 下层的 TCP 协议改成了 UDP</strong>，基于 UDP 的 <strong>QUIC 协议</strong> 可以实现类似 TCP 的可靠性传输：</p><ul><li>**无队头阻塞：QUIC 有自己的一套机制可以保证传输的可靠性的。当某个流发生丢包时，只会阻塞这个流，其他流不会受到影响，因此不存在队头阻塞问题。</li><li>**更快的连接建立：HTTP/3 在传输数据前虽然需要 QUIC 协议握手，但是这个握手过程只需要 1 RTT，握手的目的是为确认双方的「连接 ID」，连接迁移就是基于连接 ID 实现的</li><li><strong>连接迁移：基于 TCP 传输协议的 HTTP 协议，由于是通过四元组（源 IP、源端口、目的 IP、目的端口）确定一条 TCP 连接，所以当 IP 地址改变就需要断开连接，重新进行建立连接，而 QUIC 协议没有用四元组的方式来“绑定”连接，而是通过</strong>连接 ID** 来标记通信的两个端点，客户端和服务器可以各自选择一组 ID 来标记自己，因此即使移动设备的网络变化后，导致 IP 地址变化了，只要仍保有上下文信息（比如连接 ID、TLS 密钥等），就可以“无缝”地复用原连接，消除重连的成本，没有丝毫卡顿感，达到了<strong>连接迁移</strong>的功能。</li></ul><div id=4http-缓存技术 class=anchor></div><h2 class="relative group">4.HTTP 缓存技术
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4http-%e7%bc%93%e5%ad%98%e6%8a%80%e6%9c%af aria-label=Anchor>#</a></span></h2><div id=41-强制缓存 class=anchor></div><h3 class="relative group">4.1 强制缓存
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#41-%e5%bc%ba%e5%88%b6%e7%bc%93%e5%ad%98 aria-label=Anchor>#</a></span></h3><p>指的是只要浏览器判断缓存没有过期，则直接使用浏览器的本地缓存，决定是否<strong>使用缓存的主动性在于浏览器这边</strong>。</p><ul><li>size 项中标识的是 from disk cache，就是使用了强制缓存</li><li><code>Cache-Control</code>， 是一个相对时间；</li><li><code>Expires</code>，是一个绝对时间；</li><li>当浏览器第一次请求访问服务器资源时，服务器会在返回这个资源的同时，在 Response 头部加上 Cache-Control，Cache-Control 中设置了过期时间大小；</li><li>浏览器再次请求访问服务器中的该资源时，会先<strong>通过请求资源的时间与 Cache-Control 中设置的过期时间大小，来计算出该资源是否过期</strong>，如果没有，则使用该缓存，否则重新请求服务器；</li><li>服务器再次收到请求后，会再次更新 Response 头部的 Cache-Control</li></ul><div id=42-协商缓存 class=anchor></div><h3 class="relative group">4.2 协商缓存
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#42-%e5%8d%8f%e5%95%86%e7%bc%93%e5%ad%98 aria-label=Anchor>#</a></span></h3><p>某些请求的响应码是 <code>304</code>，这个是告诉浏览器可以使用本地缓存的资源，<strong>通过服务端告知客户端</strong>是否<strong>可以使用缓存</strong>的方式被称为协商缓存</p><p>协商缓存可以基于<strong>两种头部</strong>来实现：</p><p>第一种：请求头部中的 <code>If-Modified-Since</code> 字段与响应头部中的 <code>Last-Modified</code> 字段实现，这两个字段的意思是：</p><ul><li>响应头部中的 <code>Last-Modified</code>：标示这个响应资源的<strong>最后修改时间</strong>；</li><li>请求头部中的 <code>If-Modified-Since</code>：当资源过期了，发现响应头中具有 Last-Modified 声明，则再次发起请求的时候带上 Last-Modified 的时间，服务器收到请求后发现有 If-Modified-Since 则与被请求资源的最后修改时间进行对比（Last-Modified），如果最后修改时间较新（大），说明资源又被改过，则返回最新资源，HTTP 200 OK；如果最后修改时间较旧（小），说明资源无新修改，响应 HTTP 304 走缓存。</li></ul><p>第二种：请求头部中的 <code>If-None-Match</code> 字段与响应头部中的 <code>ETag</code> 字段：</p><ul><li>响应头部中 <code>Etag</code>：<strong>唯一标识响应资源</strong>；</li><li>请求头部中的 <code>If-None-Match</code>：<strong>当资源过期时，浏览器发现响应头里有 Etag</strong>，则再次向服务器发起请求时，会将请求头 If-None-Match 值<strong>设置为 Etag 的值</strong>。服务器收到请求后进行比对，如果资源没有变化返回 304，如果资源变化了返回 200。</li></ul></div></div><script>var oid="views_basic/network/review/02/index.md",oid_likes="likes_basic/network/review/02/index.md"</script><script type=text/javascript src=/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/basic/redis/review/01/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Redis</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2023-09-20 14:38:40 +0800 +0800">20 September 2023</time></span></span></a></span>
<span><a class="flex text-right group ml-3" href=/basic/network/review/03/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">TCP</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2023-09-18 14:24:21 +0800 +0800">18 September 2023</time></span></span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://newtsun.github.io style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>